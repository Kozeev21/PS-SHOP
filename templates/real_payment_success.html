{% extends "base.html" %}
{% block content %}
<div style="max-width: 600px; margin: 50px auto; padding: 0 20px; text-align: center;">
    <div style="background: white; padding: 40px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.1);">
        <div style="font-size: 80px; color: #28a745; margin-bottom: 20px;">
            ‚úÖ
        </div>
        
        <h1 style="color: #28a745; margin-bottom: 20px;">
            –û–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ!
        </h1>
        
        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 30px 0;">
            <p style="font-size: 18px; margin: 10px 0;">
                <strong>–í–∞—à –∑–∞–∫–∞–∑ ‚Ññ</strong>
            </p>
            <div style="font-size: 24px; font-weight: bold; color: #007bff; margin: 15px 0;">
                {{ order_number }}
            </div>
            <p style="font-size: 16px; margin: 10px 0; color: #666;">
                –ó–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç –≤ –æ–±—Ä–∞–±–æ—Ç–∫—É
            </p>
        </div>
        
        <p style="margin: 25px 0; color: #666; line-height: 1.6;">
            ‚úÖ –°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–∫—É–ø–∫—É!<br>
            üìß –î–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ –≤–∞—à—É –ø–æ—á—Ç—É<br>
            üì¶ –û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Å—Ç–∞—Ç—É—Å –≤ —Ä–∞–∑–¥–µ–ª–µ ¬´–ú–æ–∏ –∑–∞–∫–∞–∑—ã¬ª
        </p>
        
        <div style="display: flex; gap: 15px; justify-content: center; margin-top: 30px; flex-wrap: wrap;">
            <button onclick="clearCartAndRedirect('/my_orders')" 
                    style="padding: 12px 30px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; min-width: 180px;">
                üì¶ –ú–æ–∏ –∑–∞–∫–∞–∑—ã
            </button>
            
            <button onclick="clearCartAndRedirect('/shop')" 
                    style="padding: 12px 30px; background: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; min-width: 180px;">
                üõí –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏
            </button>
        </div>
        
        <div style="margin-top: 40px; padding-top: 20px; border-top: 1px solid #eee;">
            <p style="font-size: 14px; color: #666;">
                –ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –æ –∑–∞–∫–∞–∑–µ:<br>
                <a href="mailto:support@–≤–∞—à-–º–∞–≥–∞–∑–∏–Ω.com" style="color: #007bff;">support@–≤–∞—à-–º–∞–≥–∞–∑–∏–Ω.com</a>
            </p>
        </div>
    </div>
</div>

<script>
function clearCartAndRedirect(url) {
    const keysToRemove = [];
    for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key.startsWith('product_')) {
            keysToRemove.push(key);
        }
    }
    
    keysToRemove.forEach(key => localStorage.removeItem(key));
    updateCartButton();
    window.location.href = url;
}

function updateCartButton() {
    let total = 0;
    for (let key in localStorage) {
        if (key.startsWith('product_quantity_')) {
            total += parseInt(localStorage.getItem(key)) || 0;
        }
    }
    
    const cartButtons = document.querySelectorAll('[id^="cart-button"], .cart-button');
    cartButtons.forEach(button => {
        if (button) {
            button.textContent = total === 0 ? 'üõí –ö–æ—Ä–∑–∏–Ω–∞' : `üõí –ö–æ—Ä–∑–∏–Ω–∞ (${total})`;
        }
    });
}

document.addEventListener('DOMContentLoaded', function() {
    setTimeout(() => {
        const keysToRemove = [];
        for (let i = 0; i < localStorage.length; i++) {
            const key = localStorage.key(i);
            if (key.startsWith('product_')) {
                keysToRemove.push(key);
            }
        }
        
        if (keysToRemove.length > 0) {
            keysToRemove.forEach(key => localStorage.removeItem(key));
            updateCartButton();
        }
    }, 500);
});
</script>
{% endblock %}